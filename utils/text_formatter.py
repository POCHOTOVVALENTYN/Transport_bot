def format_ticket_id() -> str:
    """Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ñ–Ñ ID Ñ‚Ñ–ĞºĞµÑ‚Ñƒ"""
    from datetime import datetime
    import uuid
    return f"CMP-{datetime.now().strftime('%Y%m%d')}-{uuid.uuid4().hex[:6].upper()}"

def get_status_emoji(status: str) -> str:
    """ĞÑ‚Ñ€Ğ¸Ğ¼Ğ°Ğ½Ğ½Ñ emoji Ğ·Ğ° ÑÑ‚Ğ°Ñ‚ÑƒÑĞ¾Ğ¼"""
    status_map = {
        'new': 'ğŸ†• ĞĞ¾Ğ²Ğ°',
        'acknowledged': 'ğŸ‘€ ĞŸÑ€Ğ¸Ğ¹Ğ½ÑÑ‚Ğ°',
        'in_progress': 'âš™ï¸ Ğ’ Ñ€Ğ¾Ğ±Ğ¾Ñ‚Ñ–',
        'resolved': 'âœ… Ğ’Ğ¸Ñ€Ñ–ÑˆĞµĞ½Ğ°',
        'closed': 'ğŸ”’ Ğ—Ğ°ĞºÑ€Ğ¸Ñ‚Ğ°'
    }
    return status_map.get(status, status)

def get_priority_emoji(priority: str) -> str:
    """ĞÑ‚Ñ€Ğ¸Ğ¼Ğ°Ğ½Ğ½Ñ emoji Ğ·Ğ° Ğ¿Ñ€Ñ–Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ¾Ğ¼"""
    priority_map = {
        'low': 'ğŸŸ¢ ĞĞ¸Ğ·ÑŒĞºĞ°',
        'medium': 'ğŸŸ¡ Ğ¡ĞµÑ€ĞµĞ´Ğ½Ñ',
        'high': 'ğŸ”´ Ğ’Ğ¸ÑĞ¾ĞºĞ°',
        'critical': 'ğŸš¨ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ°'
    }
    return priority_map.get(priority, priority)

def format_feedback_message(data: dict) -> str:
    """
    Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ÑƒÑ” Ğ´Ğ°Ğ½Ñ– Ğ²Ñ–Ğ´Ğ³ÑƒĞºÑƒ/Ğ¿Ğ¾Ğ´ÑĞºĞ¸ Ğ² Ğ¾Ğ´Ğ¸Ğ½ Ñ€ÑĞ´Ğ¾Ğº Ğ´Ğ»Ñ Ğ»Ğ¾Ğ³ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ğ°Ğ±Ğ¾ Ğ²Ñ–Ğ´Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ½Ñ.
    """
    category = data.get('category', 'Ğ—Ğ²ĞµÑ€Ğ½ĞµĞ½Ğ½Ñ')
    text = data.get('text', 'Ğ‘ĞµĞ· Ñ‚ĞµĞºÑÑ‚Ñƒ')
    route = data.get('route', 'ĞĞµ Ğ²ĞºĞ°Ğ·Ğ°Ğ½Ğ¾')
    board = data.get('board', 'ĞĞµ Ğ²ĞºĞ°Ğ·Ğ°Ğ½Ğ¾')
    name = data.get('name', 'ĞĞ½Ğ¾Ğ½Ñ–Ğ¼')
    phone = data.get('phone', '')

    return (
        f"ğŸ“ [{category}]\n"
        f"ğŸ‘¤ Ğ’Ñ–Ğ´: {name} ({phone})\n"
        f"ğŸšŒ ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚: {route} | Ğ‘Ğ¾Ñ€Ñ‚: {board}\n"
        f"ğŸ’¬ Ğ¢ĞµĞºÑÑ‚: {text}"
    )


def format_stop_name(name: str) -> str:
    """
    Ğ¡ĞºĞ¾Ñ€Ğ¾Ñ‡ÑƒÑ” Ğ·Ğ°Ğ³Ğ°Ğ»ÑŒĞ½Ñ– Ğ½Ğ°Ğ·Ğ²Ğ¸ Ğ´Ğ»Ñ ĞºĞ¾Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ñ–Ğ´Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ½Ñ Ğ½Ğ° ĞºĞ½Ğ¾Ğ¿ĞºĞ°Ñ… Telegram.
    ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´: "Ğ’ÑƒĞ»Ğ¸Ñ†Ñ Ğ‘Ğ¾Ğ³Ğ´Ğ°Ğ½Ğ° Ğ¥Ğ¼ĞµĞ»ÑŒĞ½Ğ¸Ñ†ÑŒĞºĞ¾Ğ³Ğ¾" -> "Ğ²ÑƒĞ». Ğ‘Ğ¾Ğ³Ğ´Ğ°Ğ½Ğ° Ğ¥Ğ¼ĞµĞ»ÑŒĞ½Ğ¸Ñ†ÑŒĞºĞ¾Ğ³Ğ¾"
    """
    # Ğ¡Ğ»Ğ¾Ğ²Ğ½Ğ¸Ğº Ğ·Ğ°Ğ¼Ñ–Ğ½: Ñ‰Ğ¾ Ğ¼Ñ–Ğ½ÑÑ”Ğ¼Ğ¾ -> Ğ½Ğ° Ñ‰Ğ¾
    replacements = {
        "Ğ’ÑƒĞ»Ğ¸Ñ†Ñ": "Ğ²ÑƒĞ».",
        "Ğ²ÑƒĞ»Ğ¸Ñ†Ñ": "Ğ²ÑƒĞ».",
        "ĞŸÑ€Ğ¾ÑĞ¿ĞµĞºÑ‚": "Ğ¿Ñ€Ğ¾ÑĞ¿.",
        "Ğ¿Ñ€Ğ¾ÑĞ¿ĞµĞºÑ‚": "Ğ¿Ñ€Ğ¾ÑĞ¿.",
        "ĞŸĞ»Ğ¾Ñ‰Ğ°": "Ğ¿Ğ».",
        "Ğ¿Ğ»Ğ¾Ñ‰Ğ°": "Ğ¿Ğ».",
        "Ğ‘ÑƒĞ»ÑŒĞ²Ğ°Ñ€": "Ğ±ÑƒĞ».",
        "Ğ±ÑƒĞ»ÑŒĞ²Ğ°Ñ€": "Ğ±ÑƒĞ».",
        "ĞŸÑ€Ğ¾Ğ²ÑƒĞ»Ğ¾Ğº": "Ğ¿Ñ€Ğ¾Ğ².",
        "Ğ¿Ñ€Ğ¾Ğ²ÑƒĞ»Ğ¾Ğº": "Ğ¿Ñ€Ğ¾Ğ².",
        "Ğ¡Ñ‚Ğ°Ğ½Ñ†Ñ–Ñ": "ÑÑ‚.",
        "ÑÑ‚Ğ°Ğ½Ñ†Ñ–Ñ": "ÑÑ‚.",
        "Ğ—Ğ°Ğ»Ñ–Ğ·Ğ½Ğ¸Ñ‡Ğ½Ğ¸Ğ¹ Ğ²Ğ¾ĞºĞ·Ğ°Ğ»": "Ğ—. Ğ’Ğ¾ĞºĞ·Ğ°Ğ»",
        "Ğ¦ĞµĞ½Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ°Ğ²Ñ‚Ğ¾Ğ²Ğ¾ĞºĞ·Ğ°Ğ»": "Ğ¦ĞµĞ½Ñ‚Ñ€. ĞĞ²Ñ‚Ğ¾Ğ²Ğ¾Ğº.",
        "Ğ—ÑƒĞ¿Ğ¸Ğ½ĞºĞ°": "",  # Ğ¡Ğ»Ğ¾Ğ²Ğ¾ "Ğ—ÑƒĞ¿Ğ¸Ğ½ĞºĞ°" Ğ½Ğµ Ğ½ĞµÑĞµ Ñ–Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ñ–Ñ— Ğ½Ğ° ĞºĞ½Ğ¾Ğ¿Ñ†Ñ–
        "Ñ–Ğ¼ĞµĞ½Ñ–": "Ñ–Ğ¼.",
        "Ğ¡Ğ°Ğ½Ğ°Ñ‚Ğ¾Ñ€Ñ–Ğ¹": "ÑĞ°Ğ½.",
        "ÑĞ°Ğ½Ğ°Ñ‚Ğ¾Ñ€Ñ–Ğ¹": "ÑĞ°Ğ½."
    }

    clean_name = name.strip()

    # Ğ’Ğ¸ĞºĞ¾Ğ½ÑƒÑ”Ğ¼Ğ¾ Ğ·Ğ°Ğ¼Ñ–Ğ½Ğ¸
    for old, new in replacements.items():
        clean_name = clean_name.replace(old, new)

    # ĞŸÑ€Ğ¸Ğ±Ğ¸Ñ€Ğ°Ñ”Ğ¼Ğ¾ Ğ¿Ğ¾Ğ´Ğ²Ñ–Ğ¹Ğ½Ñ– Ğ¿Ñ€Ğ¾Ğ±Ñ–Ğ»Ğ¸, ÑĞºÑ– Ğ¼Ğ¾Ğ³Ğ»Ğ¸ Ğ·'ÑĞ²Ğ¸Ñ‚Ğ¸ÑÑ Ğ¿Ñ–ÑĞ»Ñ Ğ²Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ½Ñ ÑĞ»Ñ–Ğ²
    clean_name = " ".join(clean_name.split())

    # Ğ¯ĞºÑ‰Ğ¾ Ğ½Ğ°Ğ·Ğ²Ğ° Ğ²ÑĞµ Ñ‰Ğµ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ¾ Ğ´Ğ¾Ğ²Ğ³Ğ° (Ğ±Ñ–Ğ»ÑŒÑˆĞµ 30 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ–Ğ²), Ğ¾Ğ±Ñ€Ñ–Ğ·Ğ°Ñ”Ğ¼Ğ¾ Ñ—Ñ—
    if len(clean_name) > 32:
        return clean_name[:30] + ".."

    return clean_name